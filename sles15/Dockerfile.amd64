FROM invent-registry.kde.org/sysadmin/ci-images/sles15-craft@sha256:9342f7b86512a64658be8d5c53659d10ac297a5f31a10de9b1c474dd14270d03

# using a non root user doesn't work with drone ðŸ’–
# https://stackoverflow.com/a/50613378
USER root


RUN zypper --non-interactive update && \
    zypper --non-interactive install \
    # rpm
    popt-devel file-devel \
    # dpkg
    libmd-devel  ncurses-devel \
    && \
    # cleanup to ensure we don't leave behind anything that doesn't need to be in the image
    zypper --non-interactive clean -a

# the code is checked out on the host so the user will be different
RUN git config --system --add safe.directory '*'
