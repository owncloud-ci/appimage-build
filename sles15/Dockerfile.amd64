FROM invent-registry.kde.org/sysadmin/ci-images/sles15-craft@sha256:af71f526c7ac3c4fa98e760a4b9890a5b3103c78d508558fc0e0e34cff51de83

# using a non root user doesn't work with drone ðŸ’–
# https://stackoverflow.com/a/50613378
USER root


RUN zypper --non-interactive update && \
    zypper --non-interactive install \
    # rpm
    popt-devel file-devel \
    # dpkg
    libmd-devel  ncurses-devel \
    && \
    # cleanup to ensure we don't leave behind anything that doesn't need to be in the image
    zypper --non-interactive clean -a

# the code is checked out on the host so the user will be different
RUN git config --global --add safe.directory '*'
